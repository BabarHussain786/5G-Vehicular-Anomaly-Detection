# Anomaly Detection Vehicular Networks

This repository contains a multi-phase project focused on developing and testing machine learning models for anomaly detection in simulated vehicular networks. The project progresses from detecting physical traffic incidents in SUMO to predictive detection with LSTMs and a proof-of-concept for monitoring live network performance.

## Project Overview

The project is divided into three main phases, each building upon the last:

1.  **Phase 1: Traffic Anomaly Detection (Isolation Forest)**
    * A SUMO traffic simulation is run for an extended period (24 hours or 7 days).
    * A physical anomaly (a lane closure) is programmatically injected to create a traffic jam.
    * An `IsolationForest` model from scikit-learn is used to analyze the resulting speed data and detect the incident.

2.  **Phase 2: Predictive Traffic Anomaly Detection (LSTM)**
    * A Long Short-Term Memory (LSTM) neural network is trained on a clean, 24-hour dataset of *normal* traffic.
    * The trained model is then used in a new simulation to *predict* the traffic speed at each step.
    * Anomalies are detected in real-time when the *actual* speed significantly deviates from the *predicted* speed.

3.  **Phase 3: Communication Network Anomaly Detection**
    * This phase demonstrates that the same principles can be applied to the communication network itself.
    * It includes a script to monitor the **live latency** of a real network connection by pinging a server.
    * It also includes a script that generates **synthetic 5G KPI data** (latency and packet loss) with a simulated DDoS attack, which is then detected using the Isolation Forest model.

## Technologies Used

* **Simulation:** SUMO (Simulation of Urban MObility)
* **Simulation Control:** Python, TraCI
* **Data Handling:** Pandas, NumPy
* **Machine Learning:** Scikit-learn (`IsolationForest`)
* **Deep Learning:** TensorFlow, Keras (`LSTM`)
* **Visualization:** Matplotlib, Seaborn, Plotly
* **Live Network Monitoring:** `ping3`

## Installation & Setup

1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/BabarHussain786/5G-Vehicular-Anomaly-Detection.git](https://github.com/BabarHussain786/5G-Vehicular-Anomaly-Detection.git)
    cd 5G-Vehicular-Anomaly-Detection
    ```

2.  **Ensure SUMO is installed** and its tools directory is accessible in your system's PATH.

3.  **Install the required Python libraries:**
    ```bash
    pip install pandas numpy scikit-learn tensorflow matplotlib seaborn plotly ping3
    ```

## How to Run the Experiments

All Python scripts should be run from the main repository directory. Ensure your SUMO files (`map.net.xml`, `map.sumocfg`, etc.) are in a `sumo_files/` subdirectory.

### Experiment 1: Predictive Anomaly Detection (LSTM)

This is the most advanced experiment. It trains a model and then runs a live detection simulation.

1.  **Generate a route file** for the simulation inside the `sumo_files/` directory:
    ```bash
    python /path/to/sumo/tools/randomTrips.py -n sumo_files/map.net.xml -r sumo_files/map.rou.xml -e 86400 -p 4
    ```

2.  **Run the main script:**
    ```bash
    python scripts/predictive_detector_final.py
    ```
    This will generate a `predictive_detection_results.csv` file.

3.  **Visualize the results:**
    ```bash
    python scripts/visualize_results.py
    ```
    This will generate a `predictive_model_report.png` file.

### Experiment 2: Live Network Latency Monitor

This script monitors your computer's current internet connection.

* **Run the script** (you may need administrator privileges):
    ```bash
    sudo python scripts/live_latency_detector.py
    ```
    Press `Ctrl+C` to stop the monitor.

## Results

The project successfully demonstrates that machine learning models can be used to effectively detect anomalies in both simulated traffic and communication network data.

* The **Isolation Forest** model proved effective at identifying significant outliers in large datasets but was sensitive to minor, normal fluctuations.
* The **predictive LSTM model** was more robust, as it learned the *temporal patterns* of normal traffic and was better able to distinguish between minor fluctuations and major incidents.

Key plots and reports are generated by the visualization scripts and saved in the root directory.

## Future Work

* **Automated Response System:** Extend the system to automatically react to detected anomalies within SUMO (e.g., rerouting traffic).
* **Data Fusion:** Improve model accuracy by training on multiple data sources simultaneously (e.g., speed, vehicle count, and network latency).
* **Full Network Simulation:** Integrate the SUMO simulation with a dedicated network simulator like NS-3 for a more holistic analysis.
